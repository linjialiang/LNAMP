# 源代码编译前的准备

> 使用源代码编译软件包前，我们需要做下规划，并且对一些知识点也需要去了解一下。

## 做好路径规划

> 源代码编译前我们最好先规定好各种路径，下面是安装 web 开发环境需要的路径：

| 目录                | 描述                           |
| ------------------- | ------------------------------ |
| /custom/source      | 下载的源码包及其解压包存放路径 |
| /custom/build       | 使用 make 构建的数据存放路径   |
| /custom/make        | 生成 makefile 文件存放路径     |
| /custom/compile     | 最终二进制数据存放路径         |
| /custom/bin         | 可执行程序存放路径             |
| /custom/etc         | 配置文件存放路径               |
| /custom/web/mariadb | mariadb 数据目录存放路径       |
| /custom/web/www     | 站点根目录                     |
| /custom/web/logs    | 日志存放路径                   |

```shell
$ mkdir -p \
/custom/{source,build,make,compile,bin,etc} \
/custom/web/{mariadb,www,logs}
```

## 下载源码包

> 我们可以将准备安装的源码包全部下载下来

| 源码地址                                                                                                          |
| ----------------------------------------------------------------------------------------------------------------- |
| [mariadb-10.4.6.tar.gz](https://mirrors.tuna.tsinghua.edu.cn/mariadb/mariadb-10.4.6/source/mariadb-10.4.6.tar.gz) |
| [php-7.3.6.tar.bz2](https://www.php.net/distributions/php-7.3.6.tar.bz2)                                          |
| [httpd-2.4.39.tar.bz2](https://mirrors.tuna.tsinghua.edu.cn/apache/httpd/httpd-2.4.39.tar.bz2)                    |
| [nginx-1.16.0.tar.gz](https://nginx.org/download/nginx-1.16.0.tar.gz)                                             |

| github 仓库                                  |
| -------------------------------------------- |
| [mariadb](https://github.com/MariaDB/server) |
| [php](https://github.com/php/php-src)        |
| [httpd](https://github.com/apache/httpd)     |
| [nginx](https://github.com/nginx/nginx)      |

> 使用 wget 下载源码包，示例

```shell
$ wget <url>
# 假如 https 地址无法下载 ，可增加 --no-check-certificate 参数
$ wget --no-check-certificate <url>
```

> 解压源码包

```shell
$ tar -xzvf mariadb-10.4.6.tar.gz
$ tar -xzvf nginx-1.16.0.tar.gz
$ tar -xjvf httpd-2.4.39.tar.bz2
$ tar -xjvf php-7.3.6.tar.bz2
```

## 安装基础包

> 源代码编译必须先安装如下基础包：

```shell
$ apt install gcc g++ make autoconf automake libtool cmake
```

> 需要掌握的知识点：

| 知识点        | 描述                   |
| ------------- | ---------------------- |
| GNU 编译套件  |
| GNU Autotools | GNU 程序的标准构建系统 |
| cmake         |
| make          |
