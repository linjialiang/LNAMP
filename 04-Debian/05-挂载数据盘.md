# 挂载数据盘

> 安装完成后有 2 个 50G 的虚拟硬盘还未绑定到指定目录下，这里是具体操作：

## 挂载 lvm 逻辑卷

> 挂载 lvm 逻辑卷比较复杂，也是重点讲解部分！

### 删除分区

> 先将这两个数据盘的分区全部删除操作如下：

```shell
$ fdisk /dev/sdb 或 /dev/sdc
$ d
$ 回车
$ ...直到出现红色警告文字
$ w
```

### 创建 LVM 分区

> `8e` 是 lvm 分区类型的 `标识`

```shell
$ fdisk -l
$ fdisk /dev/sdb 或 /dev/sdc
$ n
$ e
$ 3次回车
$ w
$ fdisk /dev/sdb 或 /dev/sdc
$ t
$ 8e
$ w
```

### 安装 lvm2 包

> 假如 lvm2 包没有安装，是无法进行下面的操作的

```shell
$ apt list lvm2
$ apt-get install lvm2
```

### 创建逻辑卷

> 将 /dev/sdb1 和 /dev/sdc1 转化成 `LVM 物理卷`

```shell
$ pvcreate /dev/sd{b,c}1
$ pvs
$ pvscan
$ pvdisplay
```

> 将 `物理卷 /dev/sd{b,c}1` 加入 `LVM卷组 vg_data`

```shell
$ vgcreate vg_data /dev/sd{b,c}1
$ vgs
$ vgscan
$ vgdisplay
$ pvdisplay
```

> 将 `物理卷（2个数据盘）` 的容量都给 `LVM逻辑卷 lv_data`

```shell
$ lvcreate -l 100%VG -n lv_data vg_data
$ lvs
$ lvscan
$ lvdisplay
```

### 格式化逻辑卷

> 速度慢，带 -c 会检测是否坏轨

```shell
$ mkfs -V -t ext4 -c /dev/vg_data/lv_data
```

> 速度快

```shell
$ mkfs -V -t ext4 /dev/vg_data/lv_data
```

### 挂载分区

> 创建 `/data` 这个挂载目录

```shell
$ mkdir /data
```

> 挂载 lvm 逻辑分区到指定目录

```shell
$ lvdisplay
$ mount /dev/vg_data/lv_data /data
$ df -h
```

> 开机自动挂载

```shell
$ lvdisplay # 获取lv_data 的 LV Path
$ cp /etc/fstab{,.bak}
$ vi /etc/fstab
```

> 在 /etc/fstab 文件底部增加如下两行：

```conf
# /data was on /dev/vg_data/lv_data during installation
/dev/mapper/vg_data-lv_data /data       ext4    defaults        0       0
```

> 或者

```conf
# /data was on /dev/vg_data/lv_data during installation
/dev/vg_data/lv_data /data       ext4    defaults        0       0
```

### 卸载分区

```shell
$ umount /data
```

## 挂载普通分区

> 挂载普通分区非常简单，这里给大家一个思路

| 步骤         | 描述                          |
| ------------ | ----------------------------- |
| 磁盘分区     | 使用 fdisk 分区               |
| 格式化分区   | 将分区格式化成 ext4 格式      |
| 挂载         | 使用 mount 指令挂载到指定目录 |
| 卸载         | 使用 umount 指令将分区卸载    |
| 开启自动挂载 | 修改 `/etc/fstab` 文件        |

```shell
$ vi /etc/fstab
```

> 在 /etc/fstab 文件底部增加如下两行：

```conf
# /data was on /dev/sdb1 during installation
/dev/sdb1 /data       ext4    defaults        0       0
```
