# Nginx 初学者指南

> 本指南提供了对 nginx 的基本介绍，并介绍了可以使用它完成的一些简单任务。

## 启动，停止和重新加载配置

1. 启动 Nginx

   > 要启动 nginx，请运行可执行文件。使用以下语法：

   ```shell
   $ nginx
   ```

2. nginx 指令信号

   > 启动 nginx 后，可以通过使用-s 参数调用可执行文件来控制它。使用以下语法：

   ```shell
   $ nginx -s 信号
   ```

   > 可选信号列表

   | 信号            | 描述             |
   | --------------- | ---------------- |
   | nginx -s stop   | 快速关闭         |
   | nginx -s quit   | 优雅的关闭       |
   | nginx -s reload | 重新加载配置文件 |
   | nginx -s reopen | 重新打开日志文件 |

3. 信号详解

   > 例如，要停止 nginx 进程，等待 worker 进程完成服务当前请求，可以执行以下命令:

   ```shell
   # 这个命令应该在启动 nginx 的同一用户下执行。
   $ nginx -s quit
   ```

   > 要获取所有正在运行的 nginx 进程的列表，ps 可以使用该实用程序，例如，通过以下方式：

   ```shell
   $ ps -ax | grep nginx
   ```

## 配置文件的结构

> nginx 由模块组成，这些模块由配置文件中指定的指令控制。

```text
- 指令分为简单指令和块指令。
- 一个简单的指令由名称和参数组成，用空格分隔，以分号（;）结尾。
- 块指令与简单指令具有相同的结构，但它不是以分号结尾，而是以大括号（{和}）包围的一组附加指令结束。
- 如果块指令在大括号内可以有其他指令，则称为上下文（示例： events， http， server和 location）。
```

1. 全局块：配置影响 nginx 全局的指令。

   > 一般有运行 nginx 服务器的用户组，nginx 进程 pid 存放路径，日志存放路径，配置文件引入，允许生成 worker process 数等。

2. events 块：配置影响 nginx 服务器或与用户的网络连接。

   > 有每个进程的最大连接数，选取哪种事件驱动模型处理连接请求，是否允许同时接受多个网路连接，开启多个网络连接序列化等。

3. http 块：可以嵌套多个 server，配置代理，缓存，日志定义等绝大多数功能和第三方模块的配置。

   > 如文件引入，mime-type 定义，日志自定义，是否使用 sendfile 传输文件，连接超时时间，单连接请求数等。

4. server 块：配置虚拟主机的相关参数，一个 http 中可以有多个 server。

5. location 块：配置请求的路由，以及各种页面的处理情况。
