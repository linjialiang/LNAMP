# 远程仓库的使用

> 前面讲解的都是在本地上操作，如果 `Git` 没有远程仓库这个工具的话，本书源码可能就不会放到 `github` 上面了！
>
> -   本小节会通过讲解本书源码如何上传到 `github` 的过程来帮助大家理解

## 如何查看并操作 `远程仓库 URL` ？

> 如果我们这个项目是克隆的，就可以运行 `git remote` 命令来查看到
>
> -   如果是自己在本地写的项目，就需要运行 `git remote add <shorname> <url>` 命令添加一个新的远程仓库
> -   我们可以添加多个 `远程仓库 URL` ，`git remote -v` 可以查看到所有 `远程仓库 URL` 列表

### 如何确定是否有 `远程仓库 URL` ？

> `origin` 是 `Git` 给你克隆仓库服务器的默认的 `远程仓库 URL` 简写名称
> `git remote` 如果显示 `origin` 则代表有 `远程仓库 URL`
> `git remote -v` 如果显示多个地址就代表有多个 `远程仓库 URL` （在这里可以看到就一个远程仓库）

```shell
$ mkdir -p /d/demo
$ cd /d/demo
$ git clone https://github.com/linjialiang/programmer.git
$ git remote
origin
$ git remote -v
origin  https://github.com/linjialiang/programmer.git (fetch)
origin  https://github.com/linjialiang/programmer.git (push)
```

### 如何添加 `远程仓库 URL` ？

> `git remote add <shorname> <url>` 命令可以添加 `远程仓库 URL` ，并设置 `远程仓库 URL` 简写名称
> 本书项目暂时还没有添加 `远程仓库 URL` ，我们现在先为该项目添加一个 `github`  `远程仓库 URL` （关于 `github` 创建仓库，我们会在后面讲解 github 时详细讲解）

```shell
cd /d/programmer
git remote add github-programmer https://github.com/linjialiang/programmer.git
git remote
github-programer
$ git remote -v
github-programer        https://github.com/linjialiang/programmer.git (fetch)
github-programer        https://github.com/linjialiang/programmer.git (push)
```

> 与克隆仓库比较： `远程仓库 URL` 简写名称改变了，从 `origin` 变成 `github-programer`
> 下面我们在增加一个 `远程仓库 URL`

```shell
$ git remote add github-demo-programer https://github.com/linjialiang/demo-programmer.git
$ git remote
github-demo-programer
github-programer
$ git remote -v
github-demo-programer   https://github.com/linjialiang/demo-programmer.git (fetch)
github-demo-programer   https://github.com/linjialiang/demo-programmer.git (push)
github-programer        https://github.com/linjialiang/programmer.git (fetch)
github-programer        https://github.com/linjialiang/programmer.git (push)
```

### 如何修改 `远程仓库 URL` 简写名称？

> 前期写出来的 `远程仓库 URL` 简写名称经过后期测试，可能感觉不是很适合，这时候该如何修改呢？
>
> -   运行 `git remote rename <shorname> <new shorname>` 指令即可
> -   从上面的输出很明显，我写错了 `远程仓库 URL` 简写名称，下面我们就来修改了：

```shell
$ git remote rename github-demo-programer github-demo-programmer
$ git remote rename github-programer github-programmer
$ git remote
github-demo-programmer
github-programmer
```

### 如何移除 `远程仓库 URL` 呢？

> 我们能添加远程仓库，但是哪天这个远程仓库废弃了，我们就会想要将它移除掉
>
> -   使用 `git remote remove <shorname>` 指令可以移除指定的远程仓库
> -   很明显 `github-demo-programmer` 是拿来测试的，我们现在就将它移除

```shell
$ git remote remove github-demo-programmer
$ git remote
github-programmer
```

> 看情况 `github-demo-programmer` 已经被我们移除了

## 将本地仓库的数据推送到远程仓库

> -   我们只有对 `github-demo-programmer` 有写的权限，并且同一时刻没有其他人在推送数据，才能完成推送；
> -   如果在你推送数钱，已经有其他人推送了若干更新，那你的推送操作机会被驳回；
> -   你必须先把他们的更新抓取到本地，合并到自己的项目中，然后才可以再次提送！

### 查看远程仓库信息

> `git remote show [remote-name]` 指令可以查看某个远程仓库的详细信息

```shell
$ git remote show github-programmer
* remote github-programmer
  Fetch URL: https://github.com/linjialiang/programmer.git
  Push  URL: https://github.com/linjialiang/programmer.git
  HEAD branch: master
  Remote branches:
    dev    new (next fetch will store in remotes/github-programmer)
    master new (next fetch will store in remotes/github-programmer)
  Local ref configured for 'git push':
    master pushes to master (local out of date)
```

> 信息告诉我们，本地默认分支是 `master` ，远程有两个分支 `dev` `master` ，并且告诉我们运行 `git push` 是缺省推送的是将 `本地仓库的 master` 推送到 `github-programmer 远程仓库的 master`

### 从远程仓库抓取数据

> 从远程仓库抓取更新的数据，并且合并数据后，才能将本地仓库数据（如：本地仓库分支）发送给远程仓库
> `git fetch [remote-name]` 指令会到远程仓库中拉取所有你本地仓库中还没有的数据。

```shell
$ git fetch github-programmer
warning: no common commits
remote: Counting objects: 458, done.
remote: Total 458 (delta 0), reused 0 (delta 0), pack-reused 458
Receiving objects: 100% (458/458), 151.07 KiB | 175.00 KiB/s, done.
Resolving deltas: 100% (256/256), done.
From https://github.com/linjialiang/programmer
 * [new branch]      dev        -> github-programmer/dev
 * [new branch]      master     -> github-programmer/master
 * [new tag]         v2.0.9     -> v2.0.9
 * [new tag]         v0.0.1-Beta -> v0.0.1-Beta
 * [new tag]         v0.0.2-Beta -> v0.0.2-Beta
 * [new tag]         v0.0.3-Beta -> v0.0.3-Beta
 * [new tag]         v0.0.4-Beta -> v0.0.4-Beta
 * [new tag]         v0.0.5-Beta -> v0.0.5-Beta
 * [new tag]         v0.1.0-Beta -> v0.1.0-Beta
 * [new tag]         v0.1.1-Beta -> v0.1.1-Beta
 * [new tag]         v0.1.2-Beta -> v0.1.2-Beta
 * [new tag]         v0.1.3-Beta -> v0.1.3-Beta
 * [new tag]         v0.1.4-Beta -> v0.1.4-Beta
 * [new tag]         v0.1.5-Beta -> v0.1.5-Beta
 * [new tag]         v0.1.6-Beta -> v0.1.6-Beta
 * [new tag]         v0.1.7-Beta -> v0.1.7-Beta
 * [new tag]         v1.0.0      -> v1.0.0
 * [new tag]         v1.0.1      -> v1.0.1
 * [new tag]         v2.0.0      -> v2.0.0
 * [new tag]         v2.0.1      -> v2.0.1
 * [new tag]         v2.0.10     -> v2.0.10
 * [new tag]         v2.0.2      -> v2.0.2
 * [new tag]         v2.0.3      -> v2.0.3
 * [new tag]         v2.0.4      -> v2.0.4
 * [new tag]         v2.0.5      -> v2.0.5
 * [new tag]         v2.0.6      -> v2.0.6
 * [new tag]         v2.0.7      -> v2.0.7
 * [new tag]         v2.0.8      -> v2.0.8
```

### 从本地仓库推荐数据到远程仓库

> 远程仓库的 `master` 在写本节时我特意清空了内容，数据不可能会冲突，暂时就不讲解合并问题了
>
> -   `git push [remote-name] [branch-name]` 指令可以将本地仓库中的数据推送到远程仓库
> -   们就把本地仓库的 `master 分支` 推送到 `github-programmer` 服务器上

```shell
$ git add *
$ git add .gitignore
$ git commit -m '将所有项目内容提交至本地仓库！'
$ git push github-programmer master
To https://github.com/linjialiang/programmer.git
 ! [rejected]        master -> master (non-fast-forward)
error: failed to push some refs to 'https://github.com/linjialiang/programmer.git'
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Integrate the remote changes (e.g.
hint: 'git pull ...') before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.
```

> 糟糕报错了！当然很多同学可能不会出现这个问题，下面我们贴下解决方法，具体什么原理我们后续会详细讲解！

```shell
$ git pull
There is no tracking information for the current branch.
Please specify which branch you want to merge with.
See git-pull(1) for details.

    git pull <remote> <branch>

If you wish to set tracking information for this branch you can do so with:

    git branch --set-upstream-to=github-programmer/<branch> master
```

```shell
$ git pull github-programmer master --allow-unrelated-histories
$ git push github-programmer master
Counting objects: 34, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (30/30), done.
Writing objects: 100% (34/34), 50.69 KiB | 5.07 MiB/s, done.
Total 34 (delta 0), reused 6 (delta 0)
To https://github.com/linjialiang/programmer.git
   7f7a378..e80fe16  master -> master
```

> 到此，我们 `github` 上面的项目上就有了我们提交的数据了,回家以后我也能正常更新这个项目了，这对以后项目的更新进度就会有所提升了！
