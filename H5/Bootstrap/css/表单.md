# 表单

> bootstrap对表单也做了一系列的优化，这个篇幅不小

## 表单元素

> 表单元素的更多知识点，请到`HTML分类`下的 [表单](../../HTML/表单.md) 查看

| 表单类                       | 描述                              |
| ------------------------- | ------------------------------- |
| `.form-control`           | 处理文本表单控件                        |
| `.form-control-sm`        | 处理文本表单控件大小（基于 `.form-control`）  |
| `.form-control-lg`        | 处理文本表单控件大小（基于 `.form-control`）  |
| `.form-control-file`      | 处理文件上传                          |
| `.form-control-range`     | 处理数字滑块                          |
| `.col-form-label`         | 处理label字号正常                     |
| `.col-form-label-sm`      | 处理label小字号                      |
| `.col-form-label-lg`      | 处理label大字号                      |
| `.form-control-plaintext` | 处理只读文本的样式                       |
| `.form-group`             | 处理表单控件之间的行间距                    |
| `.form-text`              | 处理表单控件的帮助文本（一般以`.text-muted`结合） |
| `.form-row`               | 处理表单网格行布局                       |
| `.form-check`             | 处理表单复选框和单选框的上级                  |
| `.form-check-input`       | 处理表单复选框和单选框的input标签             |
| `.form-check-label`       | 处理表单复选框和单选框的label标签             |
| `.form-check-inline`      | 处理表单复选框和单选框，变成一行显示              |
| `.custom-control`         | 替换浏览器表单默认值，为跨浏览器量身定制            |
| `.input-group`            | 表单元素组合扩展系列                      |
| `.valid-feedback`         | 验证系列                            |
| `.valid-tooltip`          | 验证系列                            |
| `.was-validated`          | 验证系列                            |
| `.invalid-feedback`       | 验证系列                            |
| `.invalid-tooltip`        | 验证系列                            |
| `.is-invalid`             | 验证系列                            |

> `.form-control` 主要处理 `<input> <select> <textarea>` 这类文本表单控件

```html
<section class="container">
    <h3 class="text-center">这是一个表单</h3>
    <form action="index.php" method="post" enctype="text/plain" name="form1">
        <input type="text" name="name1" class="form-control form-control-sm" placeholder="小号输入框">
        <input type="text" name="name2" class="form-control" placeholder="普通输入框" >
        <input type="text" name="name3" class="form-control form-control-lg" placeholder="大号输入框">
    </form>
</section>
```

> `.form-control-file` 处理文件上传

```html
<section class="container">
    <h3 class="text-center">这是一个表单</h3>
    <form action="index.php" method="post" enctype="multipart/form-data" name="form1">
        <label for="file">文件单选</label>
        <input type="file" name="file" id="file" placeholder="上传文件" class="form-control-file">
        <label for="images">图片多选</label>
        <input multiple type="file" name="images" id="images" placeholder="上传多个文件"  class="form-control-file">
    </form>
</section>
```

> `.form-control-range` 处理输入范围的滑块

```html
<section class="container">
    <h3 class="text-center">这是一个表单</h3>
    <form action="index.php" method="post" enctype="text/plain" name="form1">
        <label for="range">一个输入范围滑块，当前值：<span></span></label>
        <input type="range" id="range" min="3" max="21" step="3" class="form-control-range">
    </form>
</section>

<script type="text/javascript">
// 需要jquery支持
$(document).ready(function(){
    $('#range').change(function(){
        var number = $('#range').val();
        $('label[for="range"] span').text(number);
    });
});
</script>
```

> `.col-form-label-*` 处理label的字号

```HTML
<section class="container">
    <h3 class="text-center">这是一个表单</h3>
    <form action="index.php" method="post" enctype="text/plain" name="form1">
        <label for="user" class="col-form-label">普通字号</label>
        <input type="text" id="user" name="user" placeholder="输入用户名" class="form-control">
        <label for="passwd" class="col-form-sm">小字号</label>
        <input type="text" id="passwd" name="passwd" placeholder="输入密码" class="form-control">
        <label for="description" class="col-form-label-lg">大字号</label>
        <textarea name="description" id="description" rows="3" placeholder="输入描述" class="form-control"></textarea>
    </form>
</section>
```

> `.form-control-plaintext` 这是专门处理只读文本的

```html
<section class="container">
    <h3 class="text-center">这是一个表单</h3>
    <form action="index.php" method="post" enctype="text/plain" name="form1">
        <label for="static-email" class="col-form-label">只读email</label>
        <input type="text" value="linjialiang@163.com" id="static-email" class="form-control-plaintext">
    </form>
</section>
```

> `.form-group` 解决表单控件间的行间距

```html
<section class="container">
    <h3 class="text-center">这是一个表单</h3>
    <form action="index.php" method="post" enctype="text/plain" name="form1">
        <div class="form-group">
            <label for="name1">小号输入框</label>
            <input type="text" name="name1" id="name1" class="form-control form-control-sm" placeholder="输入用户">
            <label for="name2">普通输入框</label>
            <input type="text" name="name2" id="name2" class="form-control" placeholder="输入用户" >
        </div>
        <div class="form-group">
            <label for="name3">大号输入框</label>
            <input type="text" name="name3" id="name3" class="form-control form-control-lg" placeholder="输入用户" >
        </div>
    </form>
</section>
```

> `.form-text` 用于处理表单描述（与 `.text-muted` 配合还能改变颜色值为灰色）

```html
<section class="container">
    <h3 class="text-center">这是一个表单</h3>
    <form action="index.php" method="post" enctype="text/plain" name="form1">
        <div class="form-group">
            <label for="name">用户名</label>
            <input type="text" name="name" id="name" class="form-control" placeholder="输入用户" aria-describedby="userHelpBlock" pattern="^[a-zA-Z_]\w{4,19}$" required>
            <small id="userHelpBlock" class="form-text text-muted">用户名必须是5-20个英文、数字、_其中2类的组合，不能以数字开头</small>
        </div>
        <div class="form-group">
            <label for="passwd">密码</label>
            <input type="password" name="passwd" id="passwd" class="form-control" placeholder="输入用户密码" aria-describedby="passwdHelpBlock" pattern="^[a-zA-Z_]\w{9,19}$" required>
            <small id="passwdHelpBlock" class="form-text text-muted">用户密码必须是10-20个英文、数字、_其中2类的组合，不能以数字开头</small>
        </div>
    </form>
</section>
```

> `.form-row` 是表中网格行 `.row` 的变体，更加适合表单，它覆盖默认的列槽，以获得更紧凑更紧凑的布局。

```html
<form action="index.php" method="post" enctype="text/plain" name="form1">
    <div class="form-row">
        <div class="col">
            <label for="user">用户名</label>
            <input type="text" name="user" placeholder="输入用户名" id="user" class="form-control" pattern="^[0-9a-zA-Z]{5,20}$">
            <small class="form-text text-muted">英文开头，5-20个英文与数字组合</small>
        </div>
        <div class="col">
            <label for="passwd">用户密码</label>
            <input type="password" name="passwd" placeholder="输入用户密码" id="passwd" class="form-control" pattern="^[a-zA-Z_][0-9a-zA-Z]{9,29}$">
            <small class="form-text text-muted">10-30个英文、数字、_组合，不能以数字开头</small>
        </div>
    </div>
</form>
```

> `.form-check` 系列，用于改变 `checkbox` `radio` 的布局

```html
<form action="index.php" method="post" enctype="text/plain" name="form1">
    <div class="form-check form-check-inline">
        <input type="radio" name="sex" id="man" value="男" class="form-check-input">
        <label for="man" class="form-check-label">男</label>
    </div>
    <div class="form-check form-check-inline">
        <input type="radio" name="sex" id="nv" value="女" class="form-check-input">
        <label for="nv" class="form-check-label">女</label>
    </div>
    <div class="form-check form-check-inline">
        <input type="radio" name="sex" id="undefined" value="未知" class="form-check-input" disabled>
        <label for="undefined" class="form-check-label">未知</label>
    </div>
    <hr>
    <div class="form-check">
        <input type="checkbox" name="first" id="first" value="1" class="form-check-input">
        <label for="first" class="form-check-label">1</label>
    </div>
    <div class="form-check">
        <input type="checkbox" name="second" id="second" value="2" class="form-check-input">
        <label for="second" class="form-check-label">2</label>
    </div>
    <div class="form-check">
        <input type="checkbox" name="thirdly" id="thirdly" value="3" class="form-check-input" disabled>
        <label for="thirdly" class="form-check-label">3</label>
    </div>
</form>
```

## `.custom-control` 系列

> `.custom-control` 系列用于修改表单在浏览器中的默认值，让各大浏览器效果一致

| 样式类                      | 描述                                           |
| ------------------------ | -------------------------------------------- |
| `.custom-control`        | 父div                                         |
| `.custom-control-inline` | 父级，配合 `.custom-control` ，让子级一行显示             |
| `.custom-control-input`  | 子级针对 `form` 元素，如：`input & select & textarea` |
| `.custom-control-label`  | 子级针对 `label` 标签                              |
| `.custom-checkbox`       | 父级，配合`.custom-control` 处理复选框                 |
| `.custom-radio`          | 父级，配合`.custom-control` 处理单选框                 |
| `.custom-switch`         | 父级，`checkbox` 对应的`label`实现切换按钮效果             |
| `.custom-select`         | 父级, 独立与 `.custom-control` 存在                 |
| `.custom-select-sm`      | 父级, 基于`.custom-select`                       |
| `.custom-select-lg`      | 父级, 基于`.custom-select`                       |
| `.custom-file`           | 父级, 独立与 `.custom-control` 存在                 |
| `.custom-file-input`     | 子级,  基于`.custom-file`                        |
| `.custom-file-label`     | 子级,  基于`.custom-file`                        |
| `.custom-range`          | 子级, 可独立存在                                    |

```html
<section class="container">
    <h3 class="text-center">这是一个表单</h3>
    <form action="index.php" method="post" enctype="text/plain" name="form1">
        <div class="custom-control custom-checkbox">
            <input type="checkbox" name="first" id="first" value="1" class="custom-control-input">
            <label for="first" class="custom-control-label">1</label>
        </div>
        <div class="custom-control custom-checkbox">
            <input type="checkbox" name="second" id="second" value="2" class="custom-control-input">
            <label for="second" class="custom-control-label">2</label>
        </div>
        <div class="custom-control custom-checkbox">
            <input type="checkbox" name="thirdly" id="thirdly" value="3" class="custom-control-input">
            <label for="thirdly" class="custom-control-label">3</label>
        </div>
        <hr>
        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" name="sex" id="man" value="男" class="custom-control-input">
            <label for="man" class="custom-control-label">男</label>
        </div>
        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" name="sex" id="nv" value="女" class="custom-control-input">
            <label for="nv" class="custom-control-label">女</label>
        </div>
        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="secrecy" name="sex" value="保密" class="custom-control-input">
            <label for="secrecy" class="custom-control-label">保密</label>
        </div>
        <hr>
        <div class="custom-switch">
            <input type="checkbox" id="checkbox-switch-1" name="checkbox-switch-1" class="custom-control-input" value="选择1">
            <label for="checkbox-switch-1" class="custom-control-label">`checkbox`的切换按钮效果</label>
        </div>
        <div class="custom-switch">
            <input type="checkbox" id="checkbox-switch-2" name="checkbox-switch-2" disabled class="custom-control-input" value="选择2">
            <label for="checkbox-switch-2" class="custom-control-label">`checkbox`的切换按钮效果,无法选择</label>
        </div>
        <hr>
        <div class="form-group">
            <select class="custom-select">
                <option selected disabled>Open this select menu</option>
                <option value="1">One</option>
                <option value="2">Two</option>
                <option value="3">Three</option>
            </select>
        </div>
        <div class="form-group">
            <select class="custom-select custom-select-sm">
                <option selected disabled>Open this select menu sm</option>
                <option value="1">One</option>
                <option value="2">Two</option>
                <option value="3">Three</option>
            </select>
        </div>
        <div class="form-group">
            <select class="custom-select custom-select-lg">
                <option selected disabled>Open this select menu lg</option>
                <option value="1">One</option>
                <option value="2">Two</option>
                <option value="3">Three</option>
            </select>
        </div>
        <hr>
        <div class="form-group">
            <div class="custom-file">
                <input type="file" name="file" class="custom-file-input" id="file">
                <label for="file" class="custom-file-label">选择单文件</label>
            </div>
        </div>
        <div class="form-group">
            <div class="custom-file">
                <input type="file" name="files" class="custom-file-input" id="files" multiple="111">
                <label for="files" class="custom-file-label">选择多文件</label>
            </div>
        </div>
        <hr>
        <div class="form-group">
            <label for="range1" class="form-label">默认滑块,当前值:<span></span></label>
            <input type="range" name="range1" id="range1" class="custom-range">
            <small class="form-text text-muted">默认滑块的取值范围0-100, 最小间隔为1</small>
        </div>
        <div class="form-group">
            <label for="range2" class="form-label">自定义滑块,当前值:<span></span></label>
            <input type="range" name="range2" min="10" max="20" step="0.5" id="range2" class="custom-range" value="10.5">
            <small class="form-text text-muted">滑块的取值范围10-20, 最小间隔为0.5, 默认值为10.5,</small>
        </div>
    </form>
</section>
<script type="text/javascript">
    // 需要jquery支持
    $(document).ready(function() {
        $('.custom-file .custom-file-input').change(function(e) {
            // type="file" 获取文件名
            if(typeof($(this).attr('multiple'))=="undefined"){
                let text = $(this).val();
                $(this).next().text(text);
            }else{
                // 这会是一个多维数组
                let filesArr = e.currentTarget.files;
                // 将name值提取出来,并处理成一维数组
                let filenameArr = [];
                for (var i = 0; i < filesArr.length; i++) {
                    filenameArr.push(filesArr[i].name);
                }
                // 一维数组转字符串
                let text = filenameArr.join(', ');
                $(this).next().text(text);
            }
        });
        // type="range" 获取类型值
        $('.custom-range').change(function(){
             $(this).prev().children('span').text($(this).val());
        });
    });
</script>
```

## `.input-group` 列表

> `.input-group` 列表用于对表单元素的组合输出
>
> -   为 `input & textarea & select` 的两侧添加文本、按钮或按钮组，可以轻松扩展表单控件

| 组合类                    | 描述                    |
| ---------------------- | --------------------- |
| `.input-group`         | 祖父级                   |
| `.input-group-prepend` | 父级，文本框在左侧             |
| `.input-group-append`  | 父级，文本框在右侧             |
| `.input-group-text`    | 子级，文本框样式              |
| `.input-group-lg`      | 祖父级，基于 `.input-group` |
| `.input-group-sm`      | 祖父级，基于 `.input-group` |

```html
<section class="container">
    <h3 class="text-center">这是一个表单</h3>
    <form action="index.php" method="post" enctype="text/plain" name="form1">
        <div class="form-group input-group">
            <div class="input-group-prepend">
                <label class="input-group-text" for="user">左侧</label>
            </div>
            <input type="text" class="form-control" placeholder="请输入用户名" name="user" id="user">
        </div>
        <div class="form-group input-group">
            <input type="text" class="form-control" placeholder="请输入姓氏" name="user1">
            <input type="text" class="form-control" placeholder="请输入名字" name="user2">
            <div class="input-group-append">
                <span class="input-group-text">右侧</span>
            </div>
        </div>
        <div class="form-group input-group">
            <!-- step 代表最小精确数值， step='3' 代表最低精确值为3，如果输入1 、2 都会验证错误 -->
            <input min="0" step="0.01" maxlength="10" type="number" class="form-control" id="money" placeholder="请输入金额" name="user2">
            <div class="input-group-append">
                <span class="input-group-text">￥</span>
                <span class="input-group-text" id="money-value">1.00</span>
            </div>
        </div>
        <hr>
        <div class="form-group input-group input-group-sm">
            <div class="input-group-prepend">
                <span class="input-group-text">小的</span>
            </div>
            <input type="text" name="small" placeholder="这是小的文本框" class="form-control">
        </div>
        <div class="form-group input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">默认的</span>
            </div>
            <input type="text" name="small" placeholder="这是默认大小的文本框" class="form-control">
        </div>
        <div class="form-group input-group input-group-lg">
            <div class="input-group-prepend">
                <span class="input-group-text">大的</span>
            </div>
            <input type="text" name="small" placeholder="这是大的文本框" class="form-control">
        </div>
        <div class="form-group input-group">
            <input type="text" name="search" placeholder="输入搜索内容" class="form-control">
            <div class="input-group-append">
                <button type="search" class="btn btn-outline-secondary" name="search">搜索</button>
            </div>
        </div>
        <div class="form-group input-group">
            <input type="text" name="search" placeholder="输入搜索内容" class="form-control">
            <div class="input-group-append">
                <button type="search" class="btn btn-outline-secondary" name="search1">搜索1</button>
                <button type="search" class="btn btn-outline-secondary" name="search2">搜索1</button>
            </div>
        </div>
        <hr>
        <div class="form-group input-group">
            <div class="input-group-prepend">
                <label for="select" class="input-group-text">select</label>
            </div>
            <select class="form-control custom-select" name="">
                <option value="" selected disabled>请选择</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
            </select>
        </div>
        <div class="form-group input-group">
            <div class="input-group-prepend">
                <label for="description" class="input-group-text">textarea</label>
            </div>
            <textarea class="form-control" name="description" id="description" placeholder="输入描述"></textarea>
        </div>
    </form>
</section>
<script type="text/javascript">
    // 需要 jquery 支持
    $(document).ready(function() {
        $('#money').change(function() {
            $('#money-value').text($(this).val());
        });
    });
</script>
```

##

## 表单验证序列

> 用于对表单元素的验证提示与警告（表单验证推荐与custom结合使用）

| 验证类              | 范围   | 描述             |
| ---------------- | ---- | -------------- |
| `.was-validated` | 整个表单 | 正确、错误的验证样式都能输出 |
| `.is-valid`      | 单个元素 | 用于正确验证的输出样式    |
| `.is-invalid`    | 单个元素 | 用于错误验证的输出样式    |

| 验证类                 | 描述            | 是否带背景 |
| ------------------- | ------------- | ----- |
| `.valid-feedback`   | 验证正确时，输出的文字说明 | 不带背景  |
| `.valid-tooltip`    | 验证正确时，输出的文字说明 | 带背景   |
| `.invalid-feedback` | 验证错误，输出的文字说明  | 不带背景  |
| `.invalid-tooltip`  | 验证错误， 输出的文字说明 | 带背景   |

> PS：`form` 的 `novalidate` 属性，可以让表单不自动验证，这样可以更好的使用自定义样式验证了

```html
<section class="container">
    <h3 class="text-center">这是一个表单</h3>
    <form action="index.php" method="post" enctype="text/plain" name="form1" class="needs-validation" novalidate>
        <div class="form-group input-group">
            <div class="input-group-prepend">
                <label for="user" class="input-group-text">用户</label>
            </div>
            <input type="text" name="user" id="user" placeholder="请输入用户名" class="form-control" pattern="^[a-z][a-z0-9]{4,9}$" required>
            <small class="valid-feedback">用户名可用</small>
            <small class="invalid-feedback">用户名不可用</small>
        </div>
        <div class="form-group input-group">
            <div class="input-group-prepend">
                <label for="passwd" class="input-group-text">用户密码</label>
            </div>
            <input type="passwd" name="passwd" id="passwd" placeholder="请输入密码" class="form-control" pattern="^[a-zA-Z_][a-zA-Z_0-9]{9,29}$" required>
            <small class="valid-tooltip">密码输入正常</small>
            <small class="invalid-tooltip">密码输入有误</small>
        </div>
        <div class="form-group input-group">
            <div class="input-group-prepend">
                <label for="description" id="description" class="input-group-text">描述</label>
            </div>
            <textarea name="description" id="description" placeholder="请输入描述" required class="form-control"></textarea>
            <small class="valid-tooltip">输出正确</small>
            <small class="invalid-tooltip">文字不能小于10个或大于255个</small>
        </div>
        <div class="form-group input-group">
            <div class="input-group-prepend">
                <label for="select" class="input-group-text">select</label>
            </div>
            <select name="select" id="select" class="form-control custom-select" required>
                <option value="" selected disabled>请选择</option>
                <option value="1">1</option>
                <option value="2">2</option>
            </select>
            <small class="valid-tooltip">正确</small>
            <small class="invalid-tooltip">需要选择一项</small>
        </div>
        <div class="form-group input-group">
            <div class="input-group-prepend">
                <label for="select" class="input-group-text">select</label>
            </div>
            <select name="select" id="select" class="form-control custom-select" multiple required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
            </select>
            <small class="valid-tooltip">正确</small>
            <small class="invalid-tooltip">至少需要选择1项</small>
        </div>
        <div class="form-group input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">单选框</span>
                <label for="man" class="input-group-text">男</label>
                <span class="input-group-text">
                    <input type="radio" name="sex" id="man" value="男">
                </span>
                <label for="nv" class="input-group-text">女</label>
                <span class="input-group-text">
                    <input type="radio" name="sex" id="nv" value="女">
                </span>
            </div>
            <input type="text" class="form-control" disabled>
            <div class="input-group-append">
                <span class="input-group-text">
                    <input type="checkbox" name="lan" id="lan_yingyu" value="英语">
                </span>
                <label for="lan_yingyu" class="input-group-text">英语</label>
                <span class="input-group-text">
                    <input type="checkbox" name="lan" id="lan_hanyu" value="汉语">
                </span>
                <label for="lan_hanyu" class="input-group-text">汉语</label>
                <span class="input-group-text">复选框</span>
            </div>
        </div>
        <div class="form-group">
            <button class="btn btn-primary" type="submit" name="submit1">提交</button>
            <button class="btn btn-primary" type="reset" name="reset1">重置</button>
        </div>
    </form>
</section>

<script>
    $(document).ready(function() {
        // input 单个验证，焦点离开时触发
        $(".needs-validation").delegate('input, select, textarea', 'blur change keyup', function(e) {
            onValid = e.currentTarget.validity.valid;
            if (!onValid) {
                !$(this).hasClass('is-invalid') ? $(this).addClass('is-invalid') : false;
                !$(this).hasClass('is-valid') ? false : $(this).removeClass('is-valid');
            } else {
                !$(this).hasClass('is-valid') ? $(this).addClass('is-valid') : false;
                !$(this).hasClass('is-invalid') ? false : $(this).removeClass('is-invalid');
            }
        });
    });
    // 如果表单中有验证错误的元素，就禁用表单提交
    (function() {
        window.addEventListener('load', function() {
            // 获取我们想要应用自定义引导验证样式的所有表单
            var forms = document.getElementsByClassName('needs-validation');
            // 循环它们，防止提交
            var validation = Array.prototype.filter.call(forms, function(form) {
                form.addEventListener('submit', function(event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        }, false);
    })();
</script>
```
